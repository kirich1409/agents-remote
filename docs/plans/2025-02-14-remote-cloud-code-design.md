# Remote Cloud Code –Ω–∞ Android ‚Äî Design Document

**–î–∞—Ç–∞:** 2025-02-14
**–í–µ—Ä—Å–∏—è:** MVP
**–°—Ç–∞—Ç—É—Å:** Approved for Implementation

---

## 1. –û–±–∑–æ—Ä

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è
Telegram-–ø–æ–¥–æ–±–Ω–æ–µ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Cloud Code, –∑–∞–ø—É—â–µ–Ω–Ω—ã–º –Ω–∞ VPS –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤–∏–¥–µ—Ç—å –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º–∏ —Å–µ—Å—Å–∏—è–º–∏ Cloud Code –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Å–æ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–∞.

### –û—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å Cloud Code –Ω–∞ –∫–æ–º–ø–µ (–∫–∞–∫ —Å–µ–π—á–∞—Å –ø–æ –ø–æ–¥–ø–∏—Å–∫–µ), –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏–º–µ—è –¥–æ—Å—Ç—É–ø –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä—É —á–µ—Ä–µ–∑ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –ª—é–±–æ–≥–æ –º–µ—Å—Ç–∞. –ö–∞–∂–¥—ã–π —á–∞—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ‚Äî —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–∞—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–µ—Å—Å–∏—è Cloud Code.

### –¶–µ–ª–µ–≤–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫, —Ä–∞–±–æ—Ç–∞—é—â–∏–π –Ω–∞ –æ–¥–Ω–æ–º VPS, —Ö–æ—á–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å Cloud Code —Å–æ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Ä–∞–±–æ—Ç–µ –Ω–∞ –∫–æ–º–ø–µ.

---

## 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      Android –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ             ‚îÇ
‚îÇ  (UI, WebSocket —Å–ª—É—à–∞—Ç–µ–ª—å,          ‚îÇ
‚îÇ   –ª–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à)                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
    IP VPS + Token (HTTPS/WSS)
             ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞ VPS          ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ  ‚îå‚îÄ Gateway Service                 ‚îÇ
‚îÇ  ‚îÇ  (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è,       ‚îÇ
‚îÇ  ‚îÇ   —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ª–æ–≥–æ–≤)           ‚îÇ
‚îÇ  ‚îÇ                                  ‚îÇ
‚îÇ  ‚îú‚îÄ Cloud Code –ø—Ä–æ—Ü–µ—Å—Å #1 (Chat 1)  ‚îÇ
‚îÇ  ‚îú‚îÄ Cloud Code –ø—Ä–æ—Ü–µ—Å—Å #2 (Chat 2)  ‚îÇ
‚îÇ  ‚îú‚îÄ Cloud Code –ø—Ä–æ—Ü–µ—Å—Å #N (Chat N)  ‚îÇ
‚îÇ  ‚îÇ                                  ‚îÇ
‚îÇ  ‚îî‚îÄ Shared Auth Config              ‚îÇ
‚îÇ     (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π –∫–ª—é—á –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

**Backend (Gateway):**
- Node.js + Express (–∏–ª–∏ Python + FastAPI)
- WebSocket (ws –∏–ª–∏ python-socketio)
- JSON —Ñ–∞–π–ª—ã –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è (–∏–ª–∏ SQLite)

**Android:**
- Kotlin + Jetpack Compose
- OkHttp –¥–ª—è REST API
- OkHttp WebSocket –¥–ª—è real-time
- Retrofit –¥–ª—è API –∫–ª–∏–µ–Ω—Ç–∞
- Room –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫—ç—à–∞
- Android Keystore –¥–ª—è —Ç–æ–∫–µ–Ω–∞

**–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è:**
- Docker Compose
- –û–¥–∏–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–æ –≤—Å–µ–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏

---

## 3. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

### First-time setup

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –≤–≤–æ–¥–∏—Ç:**
   - IP/hostname VPS
   - –¢–æ–∫–µ–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (—Å—Ç–∞—Ç–∏—á–Ω—ã–π)

2. **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:** `POST /api/auth`
   - Gateway –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–∫–µ–Ω

3. **Gateway –æ—Ç–≤–µ—á–∞–µ—Ç:**
   - "–û—Ç–∫—Ä–æ–π—Ç–µ CLI –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ: `cloud-code auth-telegram --code=XYZ123`"

4. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ –∫–æ–º–ø–µ:**
   - –í–≤–æ–¥–∏—Ç –∫–æ–¥ –≤ CLI
   - –ê–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è –≤ Claude
   - Cloud Code —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç credentials

5. **Gateway —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç credentials** –ª–æ–∫–∞–ª—å–Ω–æ –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–ª—è –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö —á–∞—Ç–æ–≤

### –†–µ–∑—É–ª—å—Ç–∞—Ç
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ª–æ–≥–∏–Ω–∏—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑. –í—Å–µ –Ω–æ–≤—ã–µ —Å–µ—Å—Å–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é.

### –•—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
- **–ú–æ–±–∏–ª—å–Ω–∏–∫:** Android Keystore (–≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—Ç—ã)
- **VPS:** Environment variable –∏–ª–∏ –∫–æ–Ω—Ñ–∏–≥ —Ñ–∞–π–ª
- **–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è:** –¢–æ–ª—å–∫–æ HTTPS/WSS (TLS 1.3+)

---

## 4. –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —á–∞—Ç–∞ (Session)

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —á–∞—Ç–∞

```
User —Ç–∞–ø–∏—Ç "+ New Chat"
    ‚Üì
POST /api/chats
    ‚Üì
Gateway:
  1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç session_id (UUID)
  2. –°–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª: chats/{session_id}.json
  3. –ó–∞–ø—É—Å–∫–∞–µ—Ç: cloud-code start --session-id=abc123
  4. Cloud Code –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
  5. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ shared auth config
    ‚Üì
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
  1. –ü–æ–ª—É—á–∞–µ—Ç –Ω–æ–≤—ã–π —á–∞—Ç –≤ —Å–ø–∏—Å–∫–µ
  2. –í–∏–¥–∏—Ç –ø—É—Å—Ç–æ–π —á–∞—Ç
  3. –ì–æ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫–æ–º–∞–Ω–¥—ã
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥—ã

```
User –≤–≤–æ–¥–∏—Ç: "npm install"
    ‚Üì
POST /api/chats/{session_id}/messages
Header: X-Session-Id: {session_id}
Body: { "content": "npm install" }
    ‚Üì
Gateway:
  1. –ü–µ—Ä–µ–¥–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É –≤ –ø—Ä–æ—Ü–µ—Å—Å Cloud Code
  2. Cloud Code –≤—ã–ø–æ–ª–Ω—è–µ—Ç
    ‚Üì
Cloud Code –≤—ã–≤–æ–¥–∏—Ç –ª–æ–≥–∏:
  1. "Building..."
  2. "Bundle size..."
  3. "Done ‚úì"
    ‚Üì
–ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ WebSocket:
  message:output ‚Üí { "text": "Building...", "timestamp": "..." }
  message:output ‚Üí { "text": "Bundle size...", "timestamp": "..." }
  chat:completed ‚Üí { "status": "success", "timestamp": "..." }
    ‚Üì
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (–ø–æ —Å—Ç—Ä–æ–∫–∞–º)
```

### –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —á–∞—Ç–∞–º–∏

```
User —Ç–∞–ø–∏—Ç –Ω–∞ Chat #2
    ‚Üì
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
  1. –û—Ç–∫–ª—é—á–∞–µ—Ç—Å—è –æ—Ç WebSocket Chat #1
  2. GET /api/chats/chat-2-id?limit=100
     (–∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å–æ–æ–±—â–µ–Ω–∏–π)
  3. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ WebSocket Chat #2
    ‚Üì
UI –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è:
  1. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é Chat #2
  2. –ì–æ—Ç–æ–≤ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –Ω–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è –æ—Ç Chat #2
```

### –ó–∞–∫—Ä—ã—Ç–∏–µ —á–∞—Ç–∞

```
User —Å–≤–∞–π–ø–∏—Ç —á–∞—Ç –≤–ª–µ–≤–æ –∏ –Ω–∞–∂–∏–º–∞–µ—Ç Delete
    ‚Üì
DELETE /api/chats/{session_id}
    ‚Üì
Gateway:
  1. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç SIGTERM –≤ –ø—Ä–æ—Ü–µ—Å—Å Cloud Code
  2. –ñ–¥–µ—Ç graceful shutdown (5 —Å–µ–∫)
  3. –ï—Å–ª–∏ –Ω–µ –≤—ã–∫–ª—é—á–∏–ª—Å—è ‚Üí SIGKILL
  4. –ê—Ä—Ö–∏–≤–∏—Ä—É–µ—Ç/—É–¥–∞–ª—è–µ—Ç —Ñ–∞–π–ª—ã
    ‚Üì
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
  1. –ß–∞—Ç –∏—Å—á–µ–∑–∞–µ—Ç –∏–∑ —Å–ø–∏—Å–∫–∞
```

---

## 5. –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (Persistence)

### –ù–∞ VPS

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤:**
```
/app/data/
‚îú‚îÄ‚îÄ chats/
‚îÇ   ‚îú‚îÄ‚îÄ session-uuid-1.json      (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —á–∞—Ç–∞ + –∏—Å—Ç–æ—Ä–∏—è)
‚îÇ   ‚îú‚îÄ‚îÄ session-uuid-2.json
‚îÇ   ‚îî‚îÄ‚îÄ session-uuid-N.json
‚îú‚îÄ‚îÄ logs/
‚îÇ   ‚îú‚îÄ‚îÄ session-uuid-1.log       (raw –ª–æ–≥–∏ Cloud Code)
‚îÇ   ‚îî‚îÄ‚îÄ session-uuid-N.log
‚îî‚îÄ‚îÄ auth/
    ‚îî‚îÄ‚îÄ credentials.json          (shared auth config)
```

**–§–æ—Ä–º–∞—Ç chats/session-uuid.json:**
```json
{
  "session_id": "uuid",
  "created_at": "2025-02-14T10:30:00Z",
  "last_activity": "2025-02-14T10:35:00Z",
  "messages": [
    {
      "id": "uuid",
      "role": "user",
      "content": "npm install",
      "timestamp": "2025-02-14T10:31:00Z"
    },
    {
      "id": "uuid",
      "role": "assistant",
      "content": "Building...",
      "timestamp": "2025-02-14T10:31:05Z"
    }
  ]
}
```

### –ù–∞ –º–æ–±–∏–ª—å–Ω–∏–∫–µ

**SQLite –±–∞–∑–∞ (–ª–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à):**
- –¢–∞–±–ª–∏—Ü–∞ `chats`: —Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ —Å metadata
- –¢–∞–±–ª–∏—Ü–∞ `messages`: –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å–æ–æ–±—â–µ–Ω–∏–π –∫–∞–∂–¥–æ–≥–æ —á–∞—Ç–∞ (lazy load)
- –¢–∞–±–ª–∏—Ü–∞ `app_state`: –ø–æ—Å–ª–µ–¥–Ω–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π session_id

**Keystore:**
- –¢–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω Android'–æ–º)

### –ü—Ä–∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

1. User –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –í–≤–æ–¥–∏—Ç IP VPS + —Ç–æ–∫–µ–Ω
3. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: `GET /api/chats` (–ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —á–∞—Ç–æ–≤ —Å VPS)
4. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –∫–∞–∂–¥–æ–≥–æ —á–∞—Ç–∞ (lazy loading)
5. –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç

---

## 6. API REST Endpoints

### Authentication
```
POST /api/auth
  Input:  { token: "app-token", vps_ip: "..." }
  Output: { session_id: "...", message: "Authenticate via CLI" }
  Status: 200 / 401
```

### Chats Management
```
GET /api/chats
  Output: [{ id, created_at, last_message, last_activity }, ...]
  Status: 200

POST /api/chats
  Output: { session_id, created_at }
  Status: 201

GET /api/chats/{session_id}
  Query:  ?limit=100&offset=0
  Output: { session_id, messages: [...], metadata: {...} }
  Status: 200

DELETE /api/chats/{session_id}
  Status: 204
```

### Messages
```
POST /api/chats/{session_id}/messages
  Input:  { content: "npm install" }
  Header: X-Session-Id: {session_id}
  Status: 201

GET /api/chats/{session_id}/messages
  Query:  ?limit=100&offset=0
  Output: { messages: [...] }
  Status: 200
```

### Headers (–≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã)
```
X-Session-Id: {session_id}
Authorization: Bearer {token}
Content-Type: application/json
```

---

## 7. WebSocket Events

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
```
wss://vps-ip:3000/ws?session_id={session_id}&token={token}
```

### –°–æ–±—ã—Ç–∏—è (Gateway ‚Üí –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)

```
message:new
  Payload: { role: "assistant|user", content: "...", timestamp: "..." }
  –ö–æ–≥–¥–∞: –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç Claude

message:output
  Payload: { text: "Building...", timestamp: "..." }
  –ö–æ–≥–¥–∞: –í—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥—ã (–ø–æ—Å—Ç—Ä–æ—á–Ω–æ, –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏)

chat:error
  Payload: { error: "Command failed", code: "...", timestamp: "..." }
  –ö–æ–≥–¥–∞: –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã

chat:completed
  Payload: { status: "success|error", timestamp: "..." }
  –ö–æ–≥–¥–∞: –ö–æ–º–∞–Ω–¥–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ (—É—Å–ø–µ—à–Ω–æ –∏–ª–∏ —Å –æ—à–∏–±–∫–æ–π)

connection:status
  Payload: { status: "online|offline|idle" }
  –ö–æ–≥–¥–∞: –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞

process:idle
  Payload: { idle_since: "..." }
  –ö–æ–≥–¥–∞: –ü—Ä–æ—Ü–µ—Å—Å –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω > 5 –º–∏–Ω
```

### –°–æ–±—ã—Ç–∏—è (–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Üí Gateway)

```
message:send
  Payload: { content: "npm install" }

connection:ping
  Payload: {}
  –ö–æ–≥–¥–∞: Keep-alive –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫
```

---

## 8. Android UI (Telegram-–ø–æ–¥–æ–±–Ω—ã–π)

### Layout

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  Remote Cloud Code                        ‚ãØ ‚öôÔ∏è üìµ      ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë                                                        ‚ïë
‚ïë  –ß–∞—Ç—ã (—Å–ø–∏—Å–æ–∫):          Active Chat (Chat #2):       ‚ïë
‚ïë  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚ïë
‚ïë  ‚îÇ ‚úì Chat 1           ‚îÇ  ‚îÇ 10:31 You:               ‚îÇ ‚ïë
‚ïë  ‚îÇ npm install...     ‚îÇ  ‚îÇ > npm install            ‚îÇ ‚ïë
‚ïë  ‚îÇ 10:30              ‚îÇ  ‚îÇ                          ‚îÇ ‚ïë
‚ïë  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  ‚îÇ 10:31 Assistant:         ‚îÇ ‚ïë
‚ïë  ‚îÇ ‚úì Chat 2 (active)  ‚îÇ  ‚îÇ > Building...            ‚îÇ ‚ïë
‚ïë  ‚îÇ Last: build compl..‚îÇ  ‚îÇ > Bundle size: 123kb     ‚îÇ ‚ïë
‚ïë  ‚îÇ 10:35              ‚îÇ  ‚îÇ > Done ‚úì                 ‚îÇ ‚ïë
‚ïë  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  ‚îÇ                          ‚îÇ ‚ïë
‚ïë  ‚îÇ üìù Chat 3          ‚îÇ  ‚îÇ [_______] [Send ‚ñ∂]       ‚îÇ ‚ïë
‚ïë  ‚îÇ Last: test suite   ‚îÇ  ‚îÇ                          ‚îÇ ‚ïë
‚ïë  ‚îÇ 10:40              ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚ïë
‚ïë  ‚îÇ                    ‚îÇ                              ‚ïë
‚ïë  ‚îÇ + New Chat         ‚îÇ                              ‚ïë
‚ïë  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                              ‚ïë
‚ïë                                                      ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

### –ò–Ω—Ç–µ—Ä–∞–∫—Ü–∏–∏

- **–ù–∞–∂–∞—Ç—å –Ω–∞ —á–∞—Ç:** –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –Ω–µ–≥–æ (–ø–æ–¥–≥—Ä—É–∑–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é)
- **–î–æ–ª–≥–∏–π —Ç–∞–ø –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ:** –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç
- **–°–≤–∞–π–ø –≤–ª–µ–≤–æ –Ω–∞ —á–∞—Ç:** Delete –∫–Ω–æ–ø–∫–∞
- **–°–∫—Ä–æ–ª–ª –≤–≤–µ—Ä—Ö –≤ –∏—Å—Ç–æ—Ä–∏–∏:** Lazy load —Å—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–µ—â–µ 100)
- **–¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ:** –í–≤–æ–¥–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã
- **Send –∫–Ω–æ–ø–∫–∞:** –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—ã–≤–æ–¥–∞

**Lazy loading chunks:**
- Initial load: –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å–æ–æ–±—â–µ–Ω–∏–π
- –ü—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ –≤–≤–µ—Ä—Ö: –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –µ—â–µ 100
- `GET /api/chats/{id}?limit=100&offset=100`
- –¶–∏–∫–ª –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è

**RecyclerView:**
- Virtual scrolling (—Ä–µ–Ω–¥–µ—Ä–∏—Ç —Ç–æ–ª—å–∫–æ –≤–∏–¥–∏–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã)
- DiffUtil –¥–ª—è smooth animations
- –ú–∞–∫—Å–∏–º—É–º 1000 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ø–∞–º—è—Ç–∏ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö)

---

## 9. Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (4 —à—Ç—É–∫–∏ –¥–ª—è MVP)

1. **‚úÖ Command completed**
   - Title: "Command completed"
   - Body: "npm install finished successfully"
   - Tap action: –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —ç—Ç–æ–º —á–∞—Ç–µ

2. **‚ùå Command failed**
   - Title: "Error in Chat #2"
   - Body: "npm: command not found"
   - Tap action: –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —ç—Ç–æ–º —á–∞—Ç–µ

3. **üí¨ New Claude response** (–µ—Å–ª–∏ —á–∞—Ç –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω)
   - Title: "Chat #1"
   - Body: "I recommend using yarn instead of npm"
   - Tap action: –æ—Ç–∫—Ä—ã—Ç—å —ç—Ç–æ—Ç —á–∞—Ç

4. **üö® Process crashed**
   - Title: "Cloud Code process crashed"
   - Body: "Chat #3 is no longer available"
   - Tap action: –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### Firebase Cloud Messaging (FCM)
- Gateway –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ–∫–µ–Ω FCM –Ω–∞ –º–æ–±–∏–ª—å–Ω–∏–∫
- Gateway –∏—Å–ø–æ–ª—å–∑—É–µ—Ç FCM API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- Notifications –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ —Ñ–æ–Ω–µ

---

## 10. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ reconnection

### –ü–æ—Ç–µ—Ä—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞

```
WebSocket disconnect
    ‚Üì
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: Exponential backoff retry
  –ü–æ–ø—ã—Ç–∫–∞ 1: 1 —Å–µ–∫
  –ü–æ–ø—ã—Ç–∫–∞ 2: 2 —Å–µ–∫
  –ü–æ–ø—ã—Ç–∫–∞ 3: 4 —Å–µ–∫
  –ü–æ–ø—ã—Ç–∫–∞ 4: 8 —Å–µ–∫
  –ü–æ–ø—ã—Ç–∫–∞ 5: 16 —Å–µ–∫
    ‚Üì
–ü–æ—Å–ª–µ 5 –ø–æ–ø—ã—Ç–æ–∫:
  UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: "Disconnected. Retry?" [–∫–Ω–æ–ø–∫–∞]
  –õ–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à: –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —á—Ç–µ–Ω–∏—è
```

### Cloud Code –ø—Ä–æ—Ü–µ—Å—Å —É–ø–∞–ª

```
WebSocket event: connection:status { "status": "offline" }
    ‚Üì
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
  1. UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: "Process offline"
  2. –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ disabled
  3. Button: "Recreate session" –∏–ª–∏ "Retry"
    ‚Üì
User –º–æ–∂–µ—Ç:
  1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —á–∞—Ç
  2. –£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —á–∞—Ç –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å
```

### Timeout –∫–æ–º–∞–Ω–¥—ã (5 –º–∏–Ω)

```
–ö–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è > 5 –º–∏–Ω—É—Ç
    ‚Üì
Gateway:
  1. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç SIGTERM –ø—Ä–æ—Ü–µ—Å—Å—É
  2. –ñ–¥–µ—Ç 2 —Å–µ–∫ graceful shutdown
  3. –ï—Å–ª–∏ –Ω–µ –≤—ã–∫–ª—é—á–∏–ª—Å—è ‚Üí SIGKILL
    ‚Üì
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–∞–µ—Ç:
  chat:error { "error": "Command timeout", ... }
    ‚Üì
UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: "‚è±Ô∏è Timeout: command was terminated"
```

---

## 11. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Transport Layer
- **–¢–æ–ª—å–∫–æ HTTPS/WSS** (TLS 1.3+)
- **No HTTP/WS** (–æ–±—ã—á–Ω—ã–π Socket –±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è)

### Authentication
- **–¢–æ–∫–µ–Ω:** –£–Ω–∏–∫–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç–∏—á–Ω—ã–π –∫–ª—é—á –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **Session ID:** –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è Gateway, –Ω–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º
- **Headers:** `X-Session-Id` + `Authorization: Bearer {token}`

### Token Storage (Android)
- **Android Keystore:** –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (–≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –≤ –û–°)
- **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –≤ SharedPreferences:** (–æ—Ç–∫—Ä—ã—Ç—ã–π —Ç–µ–∫—Å—Ç)
- **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –≤ –ª–æ–≥–∞—Ö**

### VPS Security
- **Credentials:** –•—Ä–∞–Ω—è—Ç—Å—è –≤ `/app/data/auth/credentials.json` (–≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞)
- **File permissions:** 600 (—Ç–æ–ª—å–∫–æ Gateway –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å)
- **Docker:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ—Ç –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### Data
- **–õ–æ–≥–∏**: –ù–∏–∫–∞–∫–æ–≥–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (MVP –∫–æ–º–ø—Ä–æ–º–∏—Å—Å)
- **–§–∞–π–ª—ã**: –î–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

---

## 12. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ (Deployment)

### Docker Compose

**docker-compose.yml:**
```yaml
version: '3.9'

services:
  gateway:
    image: remote-cloud-code-gateway:latest
    container_name: gateway-rcc
    ports:
      - "3000:3000"
    environment:
      - APP_TOKEN=${APP_TOKEN}
      - GATEWAY_PORT=3000
      - NODE_ENV=production
    volumes:
      - ./data:/app/data
      - ./logs:/app/logs
    restart: unless-stopped
    networks:
      - rcc-network

networks:
  rcc-network:
    driver: bridge
```

### Environment Variables

```bash
# .env —Ñ–∞–π–ª
APP_TOKEN=your-unique-token-here
GATEWAY_PORT=3000
```

### –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. **–°–∫–∞—á–∞—Ç—å docker-compose.yml**
2. **–°–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª:**
   ```
   APP_TOKEN=unique-token-123
   ```
3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å:**
   ```bash
   docker-compose up -d
   ```
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
   ```bash
   docker logs gateway-rcc
   ```
5. **–í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:**
   - IP VPS: `your-vps-ip` –∏–ª–∏ `your-vps.com`
   - –¢–æ–∫–µ–Ω: `unique-token-123` (–∏–∑ .env)

---

## 13. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø—Ä–∏ reconnect

### Scenario: User –∑–∞–∫—Ä—ã–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```
User –∑–∞–∫—Ä—ã–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    ‚Üì
–ú–æ–±–∏–ª—å–Ω–∏–∫:
  1. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π session_id
  2. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–º–µ—â–µ–Ω–∏–µ (offset) –≤ –∏—Å—Ç–æ—Ä–∏–∏
  3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ DataStore
    ‚Üì
User –ø–µ—Ä–µ–æ—Ç–∫—Ä—ã–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (—á–µ—Ä–µ–∑ —á–∞—Å)
    ‚Üì
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
  1. –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç session_id
  2. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ WebSocket
  3. GET /api/chats/{session_id}?limit=100&offset=0
  4. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —Å —Ç–æ–≥–æ –∂–µ –º–µ—Å—Ç–∞
    ‚Üì
UI:
  1. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–π —á–∞—Ç
  2. –ò—Å—Ç–æ—Ä–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
  3. –ì–æ—Ç–æ–≤ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞–±–æ—Ç—É
```

---

## 14. MVP –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –ö–æ–º–ø—Ä–æ–º–∏—Å—Å—ã

| –ß—Ç–æ | –†–µ—à–µ–Ω–∏–µ –¥–ª—è MVP | Future |
|-----|-----------------|--------|
| Reply –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è | ‚ùå –ù–µ—Ç | v2 |
| –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ | ‚ùå –ù–µ—Ç | v2 |
| –ù–µ—Å–∫–æ–ª—å–∫–æ VPS | ‚ùå –û–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä | v2 |
| GitHub –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è | ‚ùå –ù–µ—Ç | v2 |
| –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–æ–≤ | ‚ùå –ù–µ—Ç | v2 |
| Health checks | ‚ùå –ù–µ—Ç | v2 |
| Rate limiting | ‚ùå –ù–µ—Ç | v2 |
| –û—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º | ‚ö†Ô∏è –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ | v2 |
| Multiple devices | ‚ùå –ù–µ—Ç | v2 |

---

## 15. Success Criteria (MVP)

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞
- ‚úÖ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π
- ‚úÖ Gateway —É–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ Cloud Code –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
- ‚úÖ API —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Android)
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ VPS
- ‚úÖ –í–∏–¥–∏—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —á–∞—Ç–æ–≤
- ‚úÖ –ú–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ —á–∞—Ç—ã
- ‚úÖ –ú–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫–æ–º–∞–Ω–¥—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –í–∏–¥–∏—Ç –≤—ã–≤–æ–¥ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ (real-time)
- ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ –ú–æ–∂–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É —á–∞—Ç–∞–º–∏
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è lazy loading (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 100)

### Performance
- ‚úÖ –í—Ä–µ–º—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: < 1 —Å–µ–∫
- ‚úÖ –ó–∞–¥–µ—Ä–∂–∫–∞ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ: < 500ms
- ‚úÖ Lazy load 100 —Å–æ–æ–±—â–µ–Ω–∏–π: < 2 —Å–µ–∫

---

## 16. –î–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏

1. **Writing-plans skill:** –°–æ–∑–¥–∞—Ç—å detailed implementation plan
2. **Backend —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:** Gateway Service (Node.js + WebSocket)
3. **Android —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (Kotlin + Compose)
4. **Integration testing:** API + WebSocket
5. **Deployment:** docker-compose –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

**End of Design Document**
